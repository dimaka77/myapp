<% @images.each do |image| %>
  <div class="img-thumbnail"><%= image_tag image.gallery.url(:thumb), alt: image.gallery.url(:thumb) %></div>
<% end %>
<h1>TEST</h1>

<script type="text/javascript">
	$(function(){
		// disable auto discover
	Dropzone.autoDiscover = false;
 

	var dropzone = new Dropzone (".dropzone", {
		maxFilesize: 256, // Set the maximum file size to 256 MB
		paramName: "image[gallery]", // Rails expects the file upload to be something like model[field_name]
		addRemoveLinks: false // Don't show remove links on dropzone itself.
	});	

	dropzone.on("success", function(file) {
		this.removeFile(file);
		$.getScript("/images");
		window.location.reload(true);
	});



Dropzone.options.imageDropzone = {
  init: function() {
    var elem, elem2;
    this.on("success", function(file, response, event) {});
    elem = document.createElement('input');
    elem.setAttribute("name", "image[id]");
    elem.setAttribute("value", response["id"]);
    elem.setAttribute("type", "hidden");
    file.previewTemplate.appendChild(elem);
    elem2 = document.createElement('input');
    elem2.setAttribute("name", "image[token]");
    elem2.setAttribute("value", response["token"]);
    elem2.setAttribute("type", "hidden");
    file.previewTemplate.appendChild(elem2);
    file.previewTemplate.addEventListener("mouseup", function(e) {
      var _this, imageId, imageToken;
      _this = this;
      e.preventDefault();
      e.stopPropagation();
      imageId = $(_this).parent().find('[name="image[id]"]').val();
      imageToken = $(_this).parent().find('[name="image[token]"]').val();
      $.ajax({
        url: "/destroyimage",
        type: "DELETE",
        dataType: "script",
        data: {
          image: {
            id: imageId,
            token: imageToken
          }
        }
      });
      return false;
    });
    return false;
  }
};

// ---
// generated by coffee-script 1.9.2


	
});


</script>